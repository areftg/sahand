"use strict";(self.webpackChunksjm=self.webpackChunksjm||[]).push([[603],{8603:(l,e,o)=>{o.r(e),o.d(e,{default:()=>x});var n=o(9379),i=o(5043),s=o(9001),a=o(6595);const r={selectedSchool:"ProfilePanel_selectedSchool__fcmc+",profilePanel:"ProfilePanel_profilePanel__LJU7K",profilePanelcont:"ProfilePanel_profilePanelcont__qke50",profilePanelLeft:"ProfilePanel_profilePanelLeft__WCljp",profilePanelRight:"ProfilePanel_profilePanelRight__VFjop",profilePanelIcon:"ProfilePanel_profilePanelIcon__ZFEQQ",profilePaneloption:"ProfilePanel_profilePaneloption__dBUAj",profiledrop:"ProfilePanel_profiledrop__5KUeJ",open:"ProfilePanel_open__42UqD",changeSchoolButton:"ProfilePanel_changeSchoolButton__MmKW5",changeSchoolIconRight:"ProfilePanel_changeSchoolIconRight__F4CAd",schoolDropdownArrow:"ProfilePanel_schoolDropdownArrow__4AZgW",schoolListContainer:"ProfilePanel_schoolListContainer__cvX+M",fadeIn:"ProfilePanel_fadeIn__FuH5g",schoolListItem:"ProfilePanel_schoolListItem__INVBu",profilePaneloptionline:"ProfilePanel_profilePaneloptionline__ozpBM",schoolDropdownArroww:"ProfilePanel_schoolDropdownArroww__B4dIW",schoolDropdownArrowContainer:"ProfilePanel_schoolDropdownArrowContainer__Y8FBU",schoolItemIcon:"ProfilePanel_schoolItemIcon__NnCj4",schoolItemInfo:"ProfilePanel_schoolItemInfo__y31ba",schoolItemDetails:"ProfilePanel_schoolItemDetails__4dvT+",disable:"ProfilePanel_disable__IvQoa"};var c=o(8335),t=o(1670),d=o(9413);const h=o.p+"static/media/change_school_icon.2baf034d278b8dcef58bb09af6844a24.svg";var p=o(7883);const f=o.p+"static/media/aboutschool.54f98cf65786ad1ff246e9255c75a67e.svg";const _=o.p+"static/media/folder.052aa88fdb3ec219127a0311b42b7e1b.svg";var v=o(8374),u=o(3916),m=o(3372),P=(o(2420),o(5182)),j=(o(8506),o(579));const x=l=>{var e,o,x,g,C,w;let{onClose:I}=l;const N=(0,s.Zp)(),{logout:A,user:b,setUser:L}=(0,a.A)(),[S,k]=(0,i.useState)([]),[B,D]=(0,i.useState)(!0),[y,Z]=(0,i.useState)(null),[M,R]=(0,i.useState)(!1),U=(null===b||void 0===b||null===(e=b.roles)||void 0===e?void 0:e.includes("parent"))||"parent"===(null===b||void 0===b||null===(o=b.role)||void 0===o?void 0:o.name),F=l=>{if(!l)return"\u0646\u0642\u0634 \u0646\u0627\u0645\u0634\u062e\u0635";const e={admin:"\u0645\u062f\u06cc\u0631 \u06a9\u0644",deputy:"\u0645\u0639\u0627\u0648\u0646",principal:"\u0645\u062f\u06cc\u0631 \u0645\u062f\u0631\u0633\u0647",teacher:"\u0645\u0639\u0644\u0645",parents:"\u0648\u0627\u0644\u062f\u06cc\u0646",parent:"\u0648\u0627\u0644\u062f\u06cc\u0646"};return Array.isArray(l)?l.map(l=>e[l]||"\u0646\u0642\u0634 \u0646\u0627\u0645\u0634\u062e\u0635").join("\u060c "):e[l]||"\u0646\u0642\u0634 \u0646\u0627\u0645\u0634\u062e\u0635"},E=(0,i.useCallback)(l=>{var e,o,i,s,a,r,c;if(!b)return;const t="admin"===(null===b||void 0===b||null===(e=b.role)||void 0===e?void 0:e.name),d=(0,n.A)((0,n.A)({},b),{},{roles:t?["admin"]:l.current_user_roles||(U?["parent"]:[]),role:(t?["admin"]:l.current_user_roles||(U?["parent"]:[]))[0]||null,selectedSchool:U?null===(o=l.active_enrollment)||void 0===o||null===(i=o.class)||void 0===i||null===(s=i.school)||void 0===s?void 0:s.id:l.id,school_id:U?null===(a=l.active_enrollment)||void 0===a||null===(r=a.class)||void 0===r||null===(c=r.school)||void 0===c?void 0:c.id:l.id,selected_child:U?l:null,selected_child_id:U?l.id:null});L(d),localStorage.setItem("user",JSON.stringify(d)),Z(l.id),d.roles&&d.roles.length>0?U||d.roles.includes("teacher")&&(D(!0),setTimeout(()=>{D(!1)},1e3)):console.warn("\u0646\u0642\u0634 \u06a9\u0627\u0631\u0628\u0631 \u062a\u0639\u0631\u06cc\u0641 \u0646\u0634\u062f\u0647!")},[b,L,U]);(0,i.useEffect)(()=>{!async function(){if(null!==b&&void 0!==b&&b.token){D(!0);try{(0,c.O5)(b.token);const l=U?c.vZ.children:c.vZ.schools,e=(await c.Ay.get(l)).data.data;k(e),1!==e.length||b.selectedSchool||b.selected_child_id||E(e[0])}catch(l){console.error(U?"\u062e\u0637\u0627 \u062f\u0631 \u062f\u0631\u06cc\u0627\u0641\u062a \u0641\u0631\u0632\u0646\u062f\u0627\u0646:":"\u062e\u0637\u0627 \u062f\u0631 \u062f\u0631\u06cc\u0627\u0641\u062a \u0645\u062f\u0627\u0631\u0633:",l)}finally{D(!1)}}}()},[null===b||void 0===b?void 0:b.token,U]);const V=(null===b||void 0===b||null===(x=b.profile)||void 0===x?void 0:x.first_name)+" "+(null===b||void 0===b||null===(g=b.profile)||void 0===g?void 0:g.last_name),W=F(null===b||void 0===b?void 0:b.roles);return(0,j.jsxs)("div",{className:r.profilePanel,children:[(0,j.jsx)("img",{className:r.profilePanelIcon,src:d.A,alt:"\u0628\u0633\u062a\u0646 \u067e\u0646\u0644",onClick:I}),(0,j.jsxs)("div",{className:r.profilePanelcont,children:[(0,j.jsx)("img",{src:t.A,alt:"\u0639\u06a9\u0633 \u067e\u0631\u0648\u0641\u0627\u06cc\u0644",className:r.profilePanelRight})," ",(0,j.jsxs)("div",{className:r.profilePanelLeft,children:[(0,j.jsx)("h2",{children:V}),(0,j.jsx)("p",{children:null===b||void 0===b||null===(C=b.profile)||void 0===C?void 0:C.phone_number}),(0,j.jsx)("p",{children:null===b||void 0===b||null===(w=b.profile)||void 0===w?void 0:w.national_code}),(0,j.jsx)("p",{children:W})]})]}),(0,j.jsxs)("div",{className:"".concat(r.profiledrop," "),children:[(0,j.jsxs)("div",{className:"".concat(r.changeSchoolButton," ").concat(M?r.open:""),onClick:()=>{R(!M)},children:[(0,j.jsx)("p",{children:U?"\u062a\u063a\u06cc\u06cc\u0631 \u0641\u0631\u0632\u0646\u062f":"\u062a\u063a\u06cc\u06cc\u0631 \u0622\u0645\u0648\u0632\u0634\u06af\u0627\u0647"}),(0,j.jsx)("div",{className:r.schoolDropdownArrowContainer,children:(0,j.jsx)("img",{src:p.A,alt:M?"\u0628\u0633\u062a\u0646 \u0644\u06cc\u0633\u062a":"\u0628\u0627\u0632 \u06a9\u0631\u062f\u0646 \u0644\u06cc\u0633\u062a",className:M?r.schoolDropdownArroww:r.schoolDropdownArrow})}),(0,j.jsx)("img",{src:h,alt:"\u062a\u063a\u06cc\u06cc\u0631",className:r.changeSchoolIconRight})]}),M&&(0,j.jsx)("div",{className:r.schoolListContainer,children:B?(0,j.jsx)(m.A,{duration:3,highlightColor:"#69b0b2",count:3,style:{margin:"1px 0",borderRadius:"6px"},height:50}):0===S.length?(0,j.jsx)("p",{children:U?"\u0641\u0631\u0632\u0646\u062f\u06cc \u06cc\u0627\u0641\u062a \u0646\u0634\u062f.":"\u0645\u062f\u0631\u0633\u0647\u200c\u0627\u06cc \u06cc\u0627\u0641\u062a \u0646\u0634\u062f."}):S.map(l=>{var e,o,n;const i=l.id===y,s=U?"".concat(l.profile.first_name," ").concat(l.profile.last_name):l.name,a=U?null===(e=l.active_enrollment)||void 0===e||null===(o=e.class)||void 0===o||null===(n=o.school)||void 0===n?void 0:n.name:l.name,c=U?"\u0641\u0631\u0632\u0646\u062f":l.current_user_roles;return(0,j.jsxs)("div",{className:"".concat(r.schoolListItem," ").concat(i?r.selectedSchool:""),onClick:()=>E(l),children:[(0,j.jsx)("img",{src:P,alt:s,className:r.schoolItemIcon}),(0,j.jsxs)("div",{className:r.schoolItemInfo,children:[(0,j.jsx)("h3",{children:s}),(0,j.jsxs)("div",{className:r.schoolItemDetails,children:[(0,j.jsxs)("p",{className:r.schoolType,children:[(0,j.jsx)("img",{src:u.A,alt:"\u0646\u0648\u0639"})," ",a||(U?"\u0645\u062f\u0631\u0633\u0647 \u0646\u0627\u0645\u0634\u062e\u0635":"\u0646\u0648\u0639 \u0646\u0627\u0645\u0634\u062e\u0635")]}),(0,j.jsx)("p",{className:r.schoolLocation,children:F(c)})]})]})]},l.id)})})]}),(0,j.jsx)("div",{className:r.profilePaneloptionline}),(0,j.jsxs)("div",{className:r.profilePaneloption,onClick:()=>N("/EditUser"),children:[(0,j.jsx)("p",{children:"\u0648\u06cc\u0631\u0627\u06cc\u0634 \u0627\u0637\u0644\u0627\u0639\u0627\u062a \u06a9\u0627\u0631\u0628\u0631\u06cc"}),(0,j.jsxs)("svg",{width:"37",height:"41",viewBox:"0 0 37 41",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,j.jsx)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M25.8828 19.1538C31.6844 19.1539 36.3877 23.8571 36.3877 29.6587C36.3875 35.4601 31.6843 40.1635 25.8828 40.1636C20.0813 40.1636 15.3781 35.4602 15.3779 29.6587C15.3779 23.8571 20.0812 19.1538 25.8828 19.1538ZM19.5547 32.7378V35.4048H22.2217L29.6055 28.021L26.9385 25.354L19.5547 32.7378ZM27.9453 24.3472L30.6123 27.0142L32.2217 25.4048L29.5547 22.7378L27.9453 24.3472Z",fill:"#69B0B2"}),(0,j.jsx)("path",{d:"M15.4316 22.9731C14.194 24.9042 13.4678 27.1948 13.4678 29.6587C13.4679 32.9743 14.7774 35.9776 16.8945 38.2046C16.3961 38.2351 15.8907 38.2534 15.3779 38.2534C6.80988 38.2534 0.0979843 33.9324 0.0976562 28.4165V27.271C0.0976562 24.9016 2.02615 22.9731 4.39551 22.9731H15.4316Z",fill:"#69B0B2"}),(0,j.jsx)("path",{d:"M15.3779 0.0532227C20.6436 0.0533706 24.9276 4.33739 24.9277 9.60303C24.9277 14.8688 20.6437 19.1537 15.3779 19.1538C10.1121 19.1538 5.82812 14.8689 5.82812 9.60303C5.8283 4.3373 10.1122 0.0532227 15.3779 0.0532227Z",fill:"#69B0B2"})]})]}),"teacher"!==(null===b||void 0===b?void 0:b.roles[0])&&"parent"!==(null===b||void 0===b?void 0:b.roles[0])&&"deputy-educational"!==(null===b||void 0===b?void 0:b.roles[0])&&"deputy-executive"!==(null===b||void 0===b?void 0:b.roles[0])&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{className:r.profilePaneloption,onClick:()=>N("/EditSchool"),children:[(0,j.jsx)("p",{children:"\u0648\u06cc\u0631\u0627\u06cc\u0634 \u0627\u0637\u0644\u0627\u0639\u0627\u062a \u0645\u062f\u0631\u0633\u0647"}),(0,j.jsx)("img",{src:f,alt:""})]}),(0,j.jsxs)("div",{className:" ".concat(r.profilePaneloption," ").concat(r.disable),children:[(0,j.jsx)("p",{children:"\u0648\u0631\u0648\u062f \u0628\u0647 \u0628\u062e\u0634 \u0628\u0627\u06cc\u06af\u0627\u0646\u06cc"}),(0,j.jsx)("img",{src:_,alt:""})]})]}),(0,j.jsxs)("div",{className:r.profilePaneloption,onClick:l=>{l.stopPropagation(),l.preventDefault(),A()},children:[(0,j.jsx)("p",{children:"\u062e\u0631\u0648\u062c \u0627\u0632 \u062d\u0633\u0627\u0628 \u06a9\u0627\u0631\u0628\u0631\u06cc"}),(0,j.jsx)("img",{src:v.A,alt:""})]})]})}}}]);
//# sourceMappingURL=603.201d9818.chunk.js.map